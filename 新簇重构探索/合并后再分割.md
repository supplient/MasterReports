# 新簇合并方法
注意，计算中所有点的坐标都是其rest position，而因为我们的点是沿一个三维网格规则采样出来的，所以rest position就对应于其拓扑坐标（voxel position）

* 对每个新簇：
  * 寻找其邻居点，设为v
  * 检查邻居点v所属的簇，找到其中最小的那个簇，设为c
  * 将新簇中的所有点合并进c中
  * 若c过大，则进行分裂


# 分裂步骤

几何划分：
* 根据簇的点集计算其投影平面的法向量
* 设原簇的点集为$X$
* 随机选择簇中一点，设其为v，过它作投影平面
* 设当前集合S和边缘集合N，初始时$S=\{v\}$，N中为v的邻居。
* 当$N$中存在到投影平面的距离值为负数的点时（总有一面的距离值为负的）：
  * 设该点为x，将x加入S，移出N，并将x未被访问过的邻居加入N
  * 重复直到循环条件不满足
* 若$|S|+1 < |X|/2$：
  * 从N中找到最小距离值的元素x，将其移出N，加入S，并将x未被访问过的邻居加入N
  * 重复直到循环条件不满足
* 若$|S| > |X|/2+1$：
  * 从S中找到最大距离值的元素x，将其移出S。（因为距离值为负，所以离投影平面越近，距离值越大）
  * 重复直到循环条件不满足
* 此时S必定连通，但X-S不一定连通，故而需要对X-S进行一些修补。

拓扑修补：
* 设点集$A$，初始时$A=S$
* 对X-S搜索其极大连通子图集合$H$，即$H$中的每一项都是X-S的一个极大连通子图
* 考虑任意极大连通子图$e\in H$：
  * 因为e极大，所以e不可到达H中其他任何子图。
  * 若e不可到达S，则因为H和S包含了所有顶点，故而e不可到达图中任何顶点。但原图为连通图，故而e应可以到达所有顶点，导出矛盾，因此e必定可以到达S。
  * 而因为e不可到达H中其他任何子图，所以e必定可直接到达S。
  * 由上述证明可知，$\forall e \in H: e可直接到达S \Rightarrow S+e为连通图$
* 我们重复选择H中顶点数最少的子图e，将其加入$A$，最后得到H中最后的子图$B$
* 则$A, B$都为连通图。
